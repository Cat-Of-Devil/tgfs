CC=@CC@
CFLAGS=@CFLAGS@ -g -O2 -Wall -Werror -c -std=c11 `pkg-config fuse --cflags` -Wno-unused-result -I./ -I./tgl
LIBS=@LIBS@ -lfuse  `pkg-config fuse --libs` -lcrypto -lz -levent
SRC=$(wildcard src/*.c) 
OBJ=$(SRC:src/%.c=build/%.o)

all: tgfs tgl

tgfs: $(OBJ) tgl
	$(CC) -o bin/$@ $(OBJ) $(LIBS) tgl/libs/libtgl.a

build/%.o: src/%.c
	$(CC) $(CFLAGS) -o $@ $<
	
tgl:
	make -C tgl
	
distclean: clean
	make -C tg clean
	rm bin/telegram-tgfs
	
clean:
	rm build/* bin/tgfs

install: all
	mv bin/* /usr/bin/

uninstall: 
	rm /usr/bin/telegram-tgfs /usr/bin/tgfs
