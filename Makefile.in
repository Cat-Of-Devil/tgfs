CC=@CC@
CFLAGS=@CFLAGS@ -g -O2 -Wall -Werror -c -std=c11 `pkg-config fuse --cflags` -Wno-unused-result -I./ -I./tgl
LIBS=@LIBS@ -lfuse  `pkg-config fuse --libs` -lcrypto -lz -levent
SRC=$(wildcard src/*.c) 
OBJ=$(SRC:src/%.c=build/%.o)

all: tgfs | tgl

tgfs: $(OBJ) | create-dir
	$(CC) -o bin/$@ $(OBJ) $(LIBS) tgl/libs/libtgl.a

build/%.o: src/%.c | tgl
	$(CC) $(CFLAGS) -o $@ $<
	
tgl: FORCE 
	make -C tgl
FORCE:
	
distclean: clean
	make -C tgl clean
	
clean:
	rm -rf build bin

create-dir:
	mkdir -p build
	mkdir -p bin

