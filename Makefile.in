CC=@CC@
CFLAGS=@CFLAGS@ -Wall -Werror -pedantic -c -std=c99 `pkg-config fuse --cflags` #-D DEBUG
LIBS=@LIBS@ `pkg-config fuse --libs`
SRC=$(wildcard *.c)
OBJ=$(SRC:%.c=%.o)
PROJECT_NAME=tgfs

all: tgfs telegram-cli

tgfs: $(OBJ) jsmn.o
	$(CC) -o $(PROJECT_NAME) $(OBJ) jsmn.o $(LIBS) 

%.o: %.c
	$(CC) $(CFLAGS) -o $@ $<

jsmn.o: jsmn/jsmn.c
	$(CC) $(CFLAGS) -o $@ $<
	
telegram-cli:
	make -C tg
	
distclean: clean
	make -C tg clean
	
clean:
	rm -rf *.o $(PROJECT_NAME)

install: all
	mv tg/bin/telegram-cli /usr/bin/telegram-tgfs
	mv tgfs /usr/bin/tgfs

uninstall: 
	rm /usr/bin/telegram-tgfs /usr/bin/tgfs
